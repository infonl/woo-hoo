graph TB
    subgraph client["Client"]
        gpp["GPP-app<br/><i>C# / .NET</i>"]
        cli["CLI<br/><i>Typer</i>"]
        curl["cURL / HTTP"]
    end

    subgraph woohoo["woo-hoo (FastAPI)"]
        api["API Router<br/><code>/api/v1/metadata/*</code>"]
        gen["MetadataGenerator<br/><i>Prompt building, response parsing</i>"]
        xml["XML Parser<br/><i>DIWOO XSD validation</i>"]
        prompts["Prompt Templates<br/><i>Dutch system + user prompts</i>"]
    end

    subgraph providers["LLM Provider"]
        direction TB
        or["OpenRouter API<br/><i>openrouter.ai</i>"]
        anthropic["Anthropic API<br/><i>Direct Messages API</i>"]
        local["Lokale LLM<br/><i>Ollama / vLLM / LocalAI</i>"]
    end

    subgraph models["LLM Models"]
        eu["EU-Based<br/><b>Mistral Large</b> (default)<br/>Mistral Medium / Small / Nemo"]
        claude["Claude<br/><i>Sonnet, Opus, Haiku</i>"]
        non_eu["Non-EU<br/><i>GPT, Gemini</i>"]
        local_model["Self-hosted<br/><i>Mistral, Llama, etc.</i>"]
    end

    subgraph gpp_stack["GPP Publicatiebank"]
        pub["Django API<br/><i>Document opslag</i>"]
    end

    gpp --> api
    cli --> api
    curl --> api

    api --> gen
    gen --> prompts
    gen --> xml

    gen -->|"OpenRouter SDK<br/>(HTTPS, via internet)"| or
    gen -->|"httpx POST<br/>(Messages API)"| anthropic
    gen -.->|"httpx POST<br/>(intern netwerk)"| local

    or --> eu
    or --> non_eu
    anthropic --> claude
    local --> local_model

    api -->|"Document ophalen<br/>via UUID"| pub

    style or fill:#f5a623,stroke:#d4831f,color:#000
    style anthropic fill:#d4a574,stroke:#b8860b,color:#000
    style local fill:#4caf50,stroke:#388e3c,color:#fff
    style eu fill:#2196f3,stroke:#1976d2,color:#fff
    style claude fill:#d4a574,stroke:#b8860b,color:#000
    style local_model fill:#4caf50,stroke:#388e3c,color:#fff
    style non_eu fill:#ff5722,stroke:#d84315,color:#fff
